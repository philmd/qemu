# Automatically generated by make - do not modify
#
# Docker multiarch cross-compiler target
#
# This docker target is builds on Debian cross compiler targets to build distro
# with a selection of cross compilers for building test binaries.
#
# On its own you can't build much but the docker-foo-cross targets
# build on top of the base debian image.
#
FROM debian:stretch-slim

# Duplicate deb line as deb-src
RUN cat /etc/apt/sources.list | sed "s/^deb\ /deb-src /" >> /etc/apt/sources.list

# Install common build utilities
RUN apt update
RUN DEBIAN_FRONTEND=noninteractive apt install -yy eatmydata
RUN DEBIAN_FRONTEND=noninteractive eatmydata \
    apt install -y --no-install-recommends \
        bison \
        build-essential \
        ca-certificates \
        clang \
        flex \
        git \
        pkg-config \
        python-minimal

MAINTAINER Philippe Mathieu-Daud√© <f4bug@amsat.org>

# Add the foreign architecture we want and install dependencies
RUN dpkg --add-architecture mips
RUN apt-get update
RUN DEBIAN_FRONTEND=noninteractive eatmydata \
    apt-get install -y --no-install-recommends \
        binutils-multiarch \
        gcc-mips-linux-gnu

# Specify the cross prefix for this image (see tests/docker/common.rc)
ENV QEMU_CONFIGURE_OPTS --cross-prefix=mips-linux-gnu-

RUN DEBIAN_FRONTEND=noninteractive eatmydata \
    apt-get build-dep -yy -a mips qemu

RUN DEBIAN_FRONTEND=noninteractive eatmydata \
    apt-get install -y --no-install-recommends \
        libbz2-dev:mips \
        liblzo2-dev:mips \
        librdmacm-dev:mips \
        libsnappy-dev:mips
