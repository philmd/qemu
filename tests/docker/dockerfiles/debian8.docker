#
# Docker multiarch cross-compiler target
#
# This docker target is builds on Debian and Emdebian's cross compiler targets
# to build distro with a selection of cross compilers for building test binaries.
#
# On its own you can't build much but the docker-foo-cross targets
# build on top of the base debian image.
#
FROM debian:jessie-slim
MAINTAINER Philippe Mathieu-Daud√© <f4bug@amsat.org>

# Setup some basic tools we need
RUN apt update
RUN DEBIAN_FRONTEND=noninteractive apt install -yy eatmydata
RUN DEBIAN_FRONTEND=noninteractive eatmydata \
    apt install -y --no-install-recommends \
        bison \
        build-essential \
        ca-certificates \
        clang \
        curl \
        flex \
        git \
        pkg-config \
        python-minimal

# Duplicate deb line as deb-src, setup Emdebian
RUN cat /etc/apt/sources.list | sed "s/^deb\ /deb-src /" >> /etc/apt/sources.list && \
    echo "deb http://emdebian.org/tools/debian/ jessie main" >> /etc/apt/sources.list && \
    curl http://emdebian.org/tools/debian/emdebian-toolchain-archive.key | apt-key add -
